% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/snv_relevant_functions.R
\name{simulate_single_nt_change}
\alias{simulate_single_nt_change}
\title{Simulate Nucleotide Change for a Single Mutation}
\usage{
simulate_single_nt_change(
  single_mutation,
  seg_list,
  genome_sequence,
  nt_transition_matrix,
  recurrent = FALSE,
  original_nt = NA
)
}
\arguments{
\item{single_mutation}{Data frame row containing information about a single mutation}

\item{seg_list}{List structure containing segment information for genome regions}

\item{genome_sequence}{List of DNA sequences representing the reference genome}

\item{nt_transition_matrix}{Matrix specifying nucleotide transition probabilities}

\item{recurrent}{Logical indicating whether this is a recurrent mutation (default: FALSE)}

\item{original_nt}{Character specifying the original nucleotide for recurrent mutations
(required when recurrent = TRUE, default: NA)}
}
\value{
The updated single_mutation row with additional fields:
\itemize{
\item seg_id: Segment identifier for the mutation
\item ref_pos: Reference position within the segment
\item original_nt: Original nucleotide at the mutation site
\item alternative_nt: Mutated nucleotide
\item processed: Set to TRUE indicating the mutation has been processed
}
}
\description{
Simulates the specific nucleotide change for a single mutation based on genomic
context, handling both regular and recurrent mutations, as well as mutations in
lost segments.
}
\details{
This function simulates nucleotide-level details for a single mutation by:
\enumerate{
\item Identifying the genomic segment containing the mutation
\item Determining if the segment has been lost through deletion or other structural variants
\item For mutations in lost segments:
\itemize{
\item Setting both original and alternative nucleotides to "N"
}
\item For mutations in non-lost segments:
\itemize{
\item For regular mutations: Looking up the original nucleotide from the reference genome
and sampling an alternative nucleotide based on the transition matrix
\item For recurrent mutations: Using the provided original nucleotide and sampling
an alternative nucleotide based on the transition matrix
}
}

The function requires the helper function get_segment_info() to map the mutation
coordinates to the appropriate genomic segment.
}
\seealso{
\code{\link{get_segment_info}}, \code{\link{sim_snv_nt_sc}}
}

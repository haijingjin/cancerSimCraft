% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/snv_relevant_functions.R
\name{sim_snv_nt_sc}
\alias{sim_snv_nt_sc}
\title{Simulate Single Nucleotide Variants for Single Cell Data}
\usage{
sim_snv_nt_sc(
  genome_sequence,
  seg_list,
  mutation_table,
  recurrent_mutation_tracker = NA,
  nt_transition_matrix
)
}
\arguments{
\item{genome_sequence}{List of DNA sequences representing the reference genome}

\item{seg_list}{Data frame or list containing genomic segment information with mapping between
chromosome coordinates and segment identifiers}

\item{mutation_table}{Data frame containing mutation information with columns:
clone, cell_index, haplotype, chrom, pos, time}

\item{recurrent_mutation_tracker}{List structure tracking recurrent mutations, organized by
genomic location and mutation sets (default is NA for no recurrent mutations)}

\item{nt_transition_matrix}{Matrix specifying nucleotide transition probabilities for
different mutation types}
}
\value{
An extended mutation_table data frame with additional columns:
\itemize{
\item seg_id: Segment identifier for the mutation
\item ref_pos: Reference position within the segment
\item original_nt: Original nucleotide at the mutation site
\item alternative_nt: Mutated nucleotide
\item processed: Logical flag indicating whether the mutation has been processed
}
}
\description{
Simulates nucleotide-level details for single nucleotide variants (SNVs) in single cell
mutation data, handling both regular and recurrent mutations with appropriate nucleotide changes.
}
\details{
This function simulates the nucleotide-level details of mutations by:
\enumerate{
\item Extending the mutation table with columns for segment ID, reference position,
original nucleotide, alternative nucleotide, and processing status
\item Processing recurrent mutations first, maintaining proper nucleotide changes across
mutation sets (later mutations in a set build upon earlier ones)
\item Processing regular (non-recurrent) mutations
}

For recurrent mutations, the function ensures that:
\itemize{
\item The first mutation in a set is processed normally
\item Subsequent mutations in the set use the alternative nucleotide from the previous
mutation as their original nucleotide
}

The function relies on helper functions:
\itemize{
\item find_identical_row_index(): To locate specific mutations in the table
\item simulate_single_nt_change(): To determine nucleotide changes for individual mutations
}
}
\seealso{
\code{\link{simulate_single_nt_change}}, \code{\link{find_identical_row_index}},
\code{\link{process_recurrent_mutation}}
}

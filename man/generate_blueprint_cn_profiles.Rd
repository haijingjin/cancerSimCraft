% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pattern_extraction.R
\name{generate_blueprint_cn_profiles}
\alias{generate_blueprint_cn_profiles}
\title{Generate Blueprint Copy Number Profiles}
\usage{
generate_blueprint_cn_profiles(
  clone_events,
  genome_window_vector,
  segment_info
)
}
\arguments{
\item{clone_events}{A named list of data frames, where each data frame contains events for a clone:
\itemize{
\item event_type: Type of event (e.g., "WGD" for whole genome duplication)
\item region_name: Region identifier or chromosome name
\item CN_change: Copy number change value
\item haplotype: "maternal" or "paternal"
}}

\item{genome_window_vector}{A character vector of window identifiers in format "chr_start_end"}

\item{segment_info}{A data frame containing segment information:
\itemize{
\item region_name: Region identifier
\item chrom: Chromosome name
\item start: Start position
\item end: End position
}}
}
\value{
A list with two elements ("maternal" and "paternal"), each containing
a data frame where:
\itemize{
\item Rows represent clones
\item Columns represent genomic windows
\item Values represent copy numbers
}
}
\description{
This function generates copy number (CN) profiles for clones based on their events and a genome-wide
window vector. It initializes baseline CN profiles for paternal and maternal haplotypes and updates
them according to the events (e.g., copy number changes, whole genome duplications) associated with
each clone. The function handles both whole chromosome events and specific region events.
}
\details{
The function processes events in these steps:
\enumerate{
\item Initializes baseline copy numbers (1 for all regions)
\item For each clone and its events:
\itemize{
\item Handles WGD by doubling all copy numbers
\item Processes chromosome-wide events if region matches "chr\link{0-9XY}+"
\item Updates specific regions based on segment information
\item Applies copy number changes progressively
}
\item Maintains separate profiles for maternal and paternal haplotypes
}
}
\note{
\itemize{
\item Copy numbers cannot go below 0
\item WGD events affect all regions simultaneously
\item Chromosome-wide events are detected by regex pattern
}
}
\examples{
\dontrun{
clone_events <- list(
  clone1 = data.frame(
    event_type = c("CN", "WGD"),
    region_name = c("chr1_p", "genome"),
    CN_change = c(1, 0),
    haplotype = c("maternal", "maternal")
  ),
  clone2 = data.frame(...)
)
genome_windows <- c("chr1_0_1000000", "chr1_1000000_2000000")
segments <- data.frame(
  region_name = "chr1_p",
  chrom = "chr1",
  start = 0,
  end = 1000000
)
profiles <- generate_blueprint_cn_profiles(clone_events, genome_windows, segments)
}

}

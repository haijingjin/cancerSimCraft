% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/snv_relevant_functions.R
\name{sim_clonal_mutation_nt}
\alias{sim_clonal_mutation_nt}
\title{Simulate Nucleotide Changes for Clonal Mutations}
\usage{
sim_clonal_mutation_nt(
  genome_sequence,
  seg_list,
  mutation_info,
  nt_transition_matrix,
  tree
)
}
\arguments{
\item{genome_sequence}{A nested list containing reference genome sequences:
\itemize{
\item First level: haplotypes (maternal/paternal)
\item Second level: chromosomes
\item Each chromosome contains nucleotide sequence
}}

\item{seg_list}{A nested list containing segment information for each clone and haplotype,
including coordinates and copy number changes.}

\item{mutation_info}{A data frame containing mutation locations with columns:
\itemize{
\item clone - Clone name where mutation occurs
\item haplotype - Maternal or paternal copy
\item chrom - Chromosome name
\item pos - Position on chromosome
}}

\item{nt_transition_matrix}{A 5x5 matrix containing nucleotide transition probabilities}

\item{tree}{An igraph object representing the phylogenetic tree structure}
}
\value{
An updated mutation_info data frame with additional columns:
\itemize{
\item seg_id - Segment identifier where mutation occurs
\item ref_pos - Position in reference coordinates
\item original_nt - Original nucleotide
\item alternative_nt - Mutated nucleotide
}
}
\description{
Simulates nucleotide changes for mutations in a clonal evolutionary tree, handling both
regular and recurrent mutations. Takes into account chromosome segment information and
possible loss events.
}
\details{
The function processes mutations in two categories:
\enumerate{
\item Regular mutations (first occurrence at a position):
\itemize{
\item Identifies segment containing the mutation
\item Handles lost segments (marked with 'N')
\item Samples alternative nucleotide based on transition matrix
}
\item Recurrent mutations (at previously mutated positions):
\itemize{
\item Finds previous mutation in ancestor clones
\item Uses previous alternative as new original nucleotide
\item Samples new alternative based on transition matrix
}
}
}
\seealso{
\code{\link{get_segment_info}}, \code{\link{get_clone_ancestors}}
}

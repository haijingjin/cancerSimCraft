% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/segment_relevant_functions.R
\name{sub_seg_from_cytoband_anno}
\alias{sub_seg_from_cytoband_anno}
\title{Create Genomic Segments from Cytoband Annotations}
\usage{
sub_seg_from_cytoband_anno(cluster_anno)
}
\arguments{
\item{cluster_anno}{A nested list containing cytoband annotations organized by
haplotype (maternal/paternal), chromosome, and cluster. Each cluster contains
a data frame of cytoband information including chromStart and chromEnd positions.}
}
\value{
A list with two elements (maternal and paternal), each containing a data frame
of genomic segments with the following columns:
\itemize{
\item chrom: Chromosome name
\item start: Starting position of the segment
\item end: Ending position of the segment
\item region_name: Unique identifier (format: "sub_haplotype_chrom_clusterIndex")
\item haplotype: Maternal or paternal
\item ref_start: Reference start position
\item ref_end: Reference end position
\item ori_start: Original start position
\item ori_end: Original end position
\item copy_index: Copy number index (initialized to 0)
\item seg_id: Segment identifier (initialized to 0)
\item CN_change: Copy number change (initialized to 0)
\item seg_source_edge: Source edge info (initialized to "root")
\item seg_source_event: Source event info (initialized to "base")
}
}
\description{
Converts clustered cytoband annotations into genomic segments by identifying
the spanning regions for each cluster. Creates segments for both maternal and
paternal haplotypes with additional metadata for downstream analysis.
}
\details{
For each cluster in the input annotations, the function:
\enumerate{
\item Identifies the minimum start and maximum end positions of all cytobands
\item Creates a unique region name using haplotype, chromosome, and cluster index
\item Initializes metadata fields for downstream analysis
\item Combines all segments into haplotype-specific data frames
}

The resulting segments serve as a baseline for further genomic analyses,
with fields prepared for tracking copy number changes and segment evolution.
}
\examples{
\dontrun{
# Assuming cluster_anno is already defined:
segments <- sub_seg_from_cytoband_anno(cluster_anno)

# Access maternal segments:
maternal_segs <- segments[["maternal"]]
}

}
\seealso{
Related functions for genomic segment analysis and manipulation
}
